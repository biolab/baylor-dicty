Selection of potential regulon genes for each replicate/strain separately:
Before, we selected genes to use in Orange clustering/tSNE if they had at least one close neighbour (with cosine similarity being equal or greater than a threshold). The cosine simililarity is calculated between two vectors. I have used all measurements for individual genes (452 measurements for all strains/replicates/times) as a single vector (e.g. concatenating all measurements together). However, while looking at expression profiles in Orange, I have noticed that some genes we selected seem to be more correlated in certain strains, but not the all of them. Thus I wanted to perform the gene selection and subsequent clustering on individual strains/replicates and then lattern find patterns conserved between strains/replicates. However, we decided on the last meeting not to go in this direction - e.g. to rather analyse data as before, on  the whole concatenated measurment vector.

As the start of above mentioned 'per strain/replicate analysis' I first needed to select candidate regulon genes for each strain/replicate. The replicates/strains have different numbers of measurements (time points) which affects cosine similarity. Thus a single threshold could not be used for all replicates/strains. Additionaly, Blaz mentioned that having a minimal regulon threshold size above inital two genes could eliminate noise (e.g. random correlation between two genes). Due to the above two notions I used a different approach for identification of potential regulon genes: I calculated 6 closest neighbours for each gene (which is actually 5 neighbours as first neighbour is always itself and has max similarity 1). I then ordered genes by average similarity to their 6 closest neighbours. I selected 1000 genes with highest average similarity to present potential regulon genes. I did this on data of individual strains (e.g. concatenating all time points of its replicates into a single vector) or on replicates (concatenating all time points of the replicate). The group termed 'all' is the vector of all measurements (strains/replicates/times), as described above.  I compared the genes selected on 'all' and genes previously used in Regulons_extraction workflow in Orange and they seem to correspond well. - So the slightly modified gene selection method seems to be able to identify regulon genes. 

Then I compared selected genes between all pairs of grops (e.g. within strains+all or replicates+all). For heatmaps I used number of shared genes between 2 groups and for hierarchical clustering I used Jaccard distance as the measure (number of shared/not shared genes between two groups). As all groups have the same number of genes the two measures should be in fact equivalent. The heatmap Compare_... shows the pairwise comparisons and heatmap CompareWithAll_... shows comparison of individual strain/replicate gene groups against 'all'. - Same as in the Compare_... heatmap row/column for 'all' but easier to look at if we want to see how the  'all' vector (which we were using in Orange and similar to what we will be using in the regulon grouping discussed on Tuesday) matches the selected genes in other groups. Additionally, I sought genes that would be present in all groups (excluding 'all' group). When genes were selected separately for each of 49 replicates I could not find a single gene that would be present in all the groups. When I did this in each of the 20  strains I found only a couple of genes present in all of them (less than 5). It is evident that genes selected on 'all' are closest to AX4, probably as we had more AX4 replicates than replicates of other individual strains. Furthermore, recplicates clustering could show if any of the replicates of a strain do not occur where we would expect them. However, a bettwer method to look at this would be a PC1 vs time or another dimension reduction method.


